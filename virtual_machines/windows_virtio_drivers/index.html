<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><link rel="canonical" href="https://kubevirt.io/user-guide/virtual_machines/windows_virtio_drivers/" />
      <link rel="shortcut icon" href="../../assets/favicon.ico" />
    <title>Windows virtio drivers - KubeVirt User-Guide</title>
    <link rel="stylesheet" href="../../css/theme.css" />
    <link rel="stylesheet" href="../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Windows virtio drivers";
        var mkdocs_page_input_path = "virtual_machines/windows_virtio_drivers.md";
        var mkdocs_page_url = "/user-guide/virtual_machines/windows_virtio_drivers/";
      </script>
    
    <script src="../../js/jquery-3.6.0.min.js" defer></script>
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/yaml.min.js"></script>
      <script>hljs.initHighlightingOnLoad();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../.." class="icon icon-home"> KubeVirt User-Guide
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../..">Welcome</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../architecture/">Architecture</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../release_notes/">KubeVirt release notes</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Operations</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../operations/installation/">Installation</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../operations/updating_and_deletion/">Updating and deletion</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../operations/basic_use/">Basic use</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../operations/api_validation/">API Validation</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../operations/debug/">Debug</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../operations/virtctl_client_tool/">virtctl Client Tool</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../operations/live_migration/">Live Migration</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../operations/hotplug_volumes/">Hotplug Volumes</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../operations/snapshot_restore_api/">Snapshot Restore API</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../operations/hugepages/">Hugepages support</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../operations/component_monitoring/">Component monitoring</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../operations/authorization/">Authorization</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../operations/annotations_and_labels/">Annotations and labels</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../operations/node_assignment/">Node assignment</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../operations/node_maintenance/">Node maintenance</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../operations/node_overcommit/">Node overcommit</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../operations/unresponsive_nodes/">Unresponsive nodes</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../operations/containerized_data_importer/">Containerized Data Importer</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../operations/activating_feature_gates/">Activating feature gates</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../operations/clone_api/">Clone API</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../operations/mediated_devices_configuration/">Mediated devices and virtual GPUs</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../operations/migration_policies/">Migration Policies</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Virtual machines</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../virtual_machine_instances/">Virtual Machines Instances</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../lifecycle/">Lifecycle</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../run_strategies/">Run Strategies</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../instancetypes/">Instancetypes and preferences</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../presets/">Presets</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../virtual_hardware/">Virtual hardware</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../dedicated_cpu_resources/">Dedicated CPU resources</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../numa/">NUMA</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../disks_and_volumes/">Disks and Volumes</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../interfaces_and_networks/">Interfaces and Networks</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../istio_service_mesh/">Istio service mesh</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../networkpolicy/">NetworkPolicy</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../host-devices/">Host Devices Assignment</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="./">Windows virtio drivers</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#do-i-need-virtio-drivers">Do I need virtio drivers?</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#which-drivers-i-need-to-install">Which drivers I need to install?</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#how-to-obtain-virtio-drivers">How to obtain virtio drivers?</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#attaching-to-virtualmachine">Attaching to VirtualMachine</a>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../guest_operating_system_information/">Guest Operating System Information</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../guest_agent_information/">Guest Agent information</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../liveness_and_readiness_probes/">Liveness and Readiness Probes</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../accessing_virtual_machines/">Accessing Virtual Machines</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../startup_scripts/">Startup Scripts</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../service_objects/">Service objects</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../templates/">Templates</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tekton_tasks/">KubeVirt Tekton</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../replicaset/">VirtualMachineInstanceReplicaSet</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../dns/">DNS records</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../boot_from_external_source/">Booting From External Source</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../confidential_computing/">Confidential computing</a>
                  </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../web_console/">Web Console</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Appendix</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../appendix/contributing/">Contributing</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../..">KubeVirt User-Guide</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../.." class="icon icon-home" alt="Docs"></a> &raquo;</li>
          <li>Virtual machines &raquo;</li>
      <li>Windows virtio drivers</li>
    <li class="wy-breadcrumbs-aside">
        <a href="https://github.com/kubevirt/user-guide/edit/main/docs/virtual_machines/windows_virtio_drivers.md"
          class="icon icon-github"> Edit on GitHub</a>
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="windows-virtio-drivers">Windows virtio drivers<a class="headerlink" href="#windows-virtio-drivers" title="Permanent link">&para;</a></h1>
<p>Purpose of this document is to explain how to install virtio drivers for
Microsoft Windows running in a fully virtualized guest.</p>
<h2 id="do-i-need-virtio-drivers">Do I need virtio drivers?<a class="headerlink" href="#do-i-need-virtio-drivers" title="Permanent link">&para;</a></h2>
<p>Yes. Without the virtio drivers, you cannot use paravirtualized hardware properly. It would either not work, or will have a severe performance penalty.</p>
<p>For more information about VirtIO and paravirtualization, see <a href="https://wiki.libvirt.org/page/Virtio">VirtIO and paravirtualization</a></p>
<p>For more details on configuring your VirtIO driver please refer to <a href="https://docs.openshift.com/container-platform/4.10/virt/virtual_machines/virt-installing-virtio-drivers-on-new-windows-vm.html">Installing VirtIO driver on a new Windows virtual machine</a> and <a href="https://docs.openshift.com/container-platform/4.10/virt/virtual_machines/virt-installing-virtio-drivers-on-existing-windows-vm.html">Installing VirtIO driver on an existing Windows virtual machine</a>.</p>
<h2 id="which-drivers-i-need-to-install">Which drivers I need to install?<a class="headerlink" href="#which-drivers-i-need-to-install" title="Permanent link">&para;</a></h2>
<p>There are usually up to 8 possible devices that are required to run
Windows smoothly in a virtualized environment. KubeVirt currently
supports only:</p>
<ul>
<li>
<p><strong>viostor</strong>, the block driver, applies to SCSI Controller in the
    Other devices group.</p>
</li>
<li>
<p><strong>viorng</strong>, the entropy source driver, applies to PCI Device in the
    Other devices group.</p>
</li>
<li>
<p><strong>NetKVM</strong>, the network driver, applies to Ethernet Controller in
    the Other devices group. Available only if a virtio NIC is
    configured.</p>
</li>
</ul>
<p>Other virtio drivers, that exists and might be supported in the future:</p>
<ul>
<li>
<p>Balloon, the balloon driver, applies to PCI Device in the Other
    devices group</p>
</li>
<li>
<p>vioserial, the paravirtual serial driver, applies to PCI Simple
    Communications Controller in the Other devices group.</p>
</li>
<li>
<p>vioscsi, the SCSI block driver, applies to SCSI Controller in the
    Other devices group.</p>
</li>
<li>
<p>qemupciserial, the emulated PCI serial driver, applies to PCI Serial
    Port in the Other devices group.</p>
</li>
<li>
<p>qxl, the paravirtual video driver, applied to Microsoft Basic
    Display Adapter in the Display adapters group.</p>
</li>
<li>
<p>pvpanic, the paravirtual panic driver, applies to Unknown device in
    the Other devices group.</p>
</li>
</ul>
<blockquote>
<p><strong>Note</strong></p>
<p>Some drivers are required in the installation phase. When you are
installing Windows onto the virtio block storage you have to provide
an appropriate virtio driver. Namely, choose viostor driver for your
version of Microsoft Windows, eg. does not install XP driver when you
run Windows 10.</p>
<p>Other drivers can be installed after the successful windows
installation. Again, please install only drivers matching your Windows
version.</p>
</blockquote>
<h3 id="how-to-install-during-windows-install">How to install during Windows install?<a class="headerlink" href="#how-to-install-during-windows-install" title="Permanent link">&para;</a></h3>
<p>To install drivers before the Windows starts its install, make sure you
have virtio-win package attached to your VirtualMachine as SATA CD-ROM.
In the Windows installation, choose advanced install and load driver.
Then please navigate to loaded Virtio CD-ROM and install one of viostor
or vioscsi, depending on whichever you have set up.</p>
<p>Step by step screenshots:</p>
<p><img alt="Windows install" src="../../assets/virtio_custom_install_0.png" /></p>
<p><img alt="Custom install" src="../../assets/virtio_custom_install_1.png" /></p>
<p><img alt="Disk install" src="../../assets/virtio_custom_install_2.png" /></p>
<p><img alt="Choose medium" src="../../assets/virtio_custom_install_3.png" /></p>
<p><img alt="Choose driver" src="../../assets/virtio_custom_install_4.png" /></p>
<p><img alt="Continue install" src="../../assets/virtio_custom_install_5.png" /></p>
<h3 id="how-to-install-after-windows-install">How to install after Windows install?<a class="headerlink" href="#how-to-install-after-windows-install" title="Permanent link">&para;</a></h3>
<p>After windows install, please go to <a href="https://support.microsoft.com/en-us/help/4026149/windows-open-device-manager">Device
Manager</a>.
There you should see undetected devices in "available devices" section.
You can install virtio drivers one by one going through this list.</p>
<p><img alt="Unknown devices" src="../../assets/virtio_driver_install_0.png" /></p>
<p><img alt="Select driver by id" src="../../assets/virtio_driver_install_1.png" /></p>
<p><img alt="Install driver" src="../../assets/virtio_driver_install_2.png" /></p>
<p><img alt="Driver installed" src="../../assets/virtio_driver_install_3.png" /></p>
<p>For more details on how to choose a proper driver and how to install the
driver, please refer to the <a href="https://access.redhat.com/articles/2470791">Windows Guest Virtual Machines on Red Hat
Enterprise Linux 7</a>.</p>
<h2 id="how-to-obtain-virtio-drivers">How to obtain virtio drivers?<a class="headerlink" href="#how-to-obtain-virtio-drivers" title="Permanent link">&para;</a></h2>
<p>The virtio Windows drivers are distributed in a form of
<a href="../disks_and_volumes/#containerdisk">containerDisk</a>,
which can be simply mounted to the VirtualMachine. The container image,
containing the disk is located at:
<a href="https://quay.io/repository/kubevirt/virtio-container-disk?tab=tags">https://quay.io/repository/kubevirt/virtio-container-disk?tab=tags</a> and the image
be pulled as any other docker container:</p>
<pre><code>docker pull quay.io/kubevirt/virtio-container-disk
</code></pre>
<p>However, pulling image manually is not required, it will be downloaded
if not present by Kubernetes when deploying VirtualMachine.</p>
<h2 id="attaching-to-virtualmachine">Attaching to VirtualMachine<a class="headerlink" href="#attaching-to-virtualmachine" title="Permanent link">&para;</a></h2>
<p>KubeVirt distributes virtio drivers for Microsoft Windows in a form of
container disk. The package contains the virtio drivers and QEMU guest
agent. The disk was tested on Microsoft Windows Server 2012. Supported
Windows version is XP and up.</p>
<p>The package is intended to be used as CD-ROM attached to the virtual
machine with Microsoft Windows. It can be used as SATA CDROM during
install phase or to provide drivers in an existing Windows installation.</p>
<p>Attaching the virtio-win package can be done simply by adding
ContainerDisk to you VirtualMachine.</p>
<pre><code>spec:
  domain:
    devices:
      disks:
        - name: virtiocontainerdisk
          # Any other disk you want to use, must go before virtioContainerDisk.
          # KubeVirt boots from disks in order ther are defined.
          # Therefore virtioContainerDisk, must be after bootable disk.
          # Other option is to choose boot order explicitly:
          #  - https://kubevirt.io/api-reference/v0.13.2/definitions.html#_v1_disk
          # NOTE: You either specify bootOrder explicitely or sort the items in
          #       disks. You can not do both at the same time.
          # bootOrder: 2
          cdrom:
            bus: sata
volumes:
  - containerDisk:
      image: quay.io/kubevirt/virtio-container-disk
    name: virtiocontainerdisk
</code></pre>
<p>Once you are done installing virtio drivers, you can remove virtio
container disk by simply removing the disk from yaml specification and
restarting the VirtualMachine.</p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../host-devices/" class="btn btn-neutral float-left" title="Host Devices Assignment"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../guest_operating_system_information/" class="btn btn-neutral float-right" title="Guest Operating System Information">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/kubevirt/user-guide/" class="fa fa-github" style="color: #fcfcfc"> GitHub</a>
        </span>
    
    
      <span><a href="../host-devices/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../guest_operating_system_information/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script>var base_url = '../..';</script>
    <script src="../../js/theme_extra.js" defer></script>
    <script src="../../js/theme.js" defer></script>
      <script src="../../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
